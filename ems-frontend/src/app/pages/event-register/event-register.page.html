@if (event(); as event) {
<div class="container mt-4">
  <h1>Register for: {{ event.title }}</h1>

  @if (success()) {
  <div class="alert alert-success">Registration successful! Redirecting...</div>
  } @else if (eventStartedError()) {
  <div class="alert alert-danger">Registration closed — this event has already started.</div>
  } @else {
  <form [formGroup]="form" (ngSubmit)="submit()" class="mt-3">
    <div class="mb-3">
      <label class="form-label">First name</label>
      <input formControlName="firstName" class="form-control" />
      @if (submitted() && form.controls.firstName.invalid) {
      <div class="text-danger small">First name is required.</div>
      }
    </div>

    <div class="mb-3">
      <label class="form-label">Last name</label>
      <input formControlName="lastName" class="form-control" />
      @if (submitted() && form.controls.lastName.invalid) {
      <div class="text-danger small">Last name is required.</div>
      }
    </div>

    <div class="mb-3">
      <label class="form-label">Email</label>
      <input formControlName="email" class="form-control" type="email" />
      @if (submitted() && form.controls.email.invalid) {
      <div class="text-danger small">A valid email is required.</div>
      }
    </div>
    <div class="d-flex gap-3">
      <button type="button" class="btn btn-secondary" [routerLink]="['/events', event.id]">Cancel</button>
      <button type="submit" class="btn btn-primary" [disabled]="eventStarted() || form.invalid">Register</button>
      @if (event && event.start_datetime && eventStarted()) {
      <div class="text-muted small mt-2">Registration closed — event has already started.</div>
      }
    </div>
  </form>
  }
</div>
} @else {
<div class="container mt-4">
  <h2>Event not found</h2>
</div>
}