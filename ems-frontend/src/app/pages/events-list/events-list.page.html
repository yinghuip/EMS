<div class="events-list-page">
  <div class="container py-5">
    <!-- Page Header -->
    <div class="page-header mb-4">
      <h1 class="display-5 mb-3">Events</h1>
      <p class="lead text-muted">Discover upcoming events and join our community</p>
    </div>

    <!-- Loading State -->
    @if (isLoading()) {
      <div class="text-center py-5" role="status" aria-live="polite">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading events...</span>
        </div>
        <p class="mt-3 text-muted">Loading events...</p>
      </div>
    }

    <!-- Error State -->
    @else if (hasError()) {
      <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading">Unable to Load Events</h4>
        <p>We encountered an error while loading the events list. Please try again.</p>
        <hr>
        <button 
          class="btn btn-danger" 
          (click)="retry()"
          type="button"
          aria-label="Retry loading events">
          <i class="bi bi-arrow-clockwise"></i> Retry
        </button>
      </div>
    }

    <!-- Main Content -->
    @else {
      <!-- Filters and Sort Controls -->
      <div class="controls-section mb-4 p-3 rounded">
        <div class="row g-3 align-items-center">
          <!-- Sort Control -->
          <div class="col-md-6">
            <label for="sort-select" class="form-label small fw-semibold">Sort By:</label>
            <select 
              id="sort-select"
              class="form-select" 
              [value]="sortOrder()"
              (change)="changeSortOrder($any($event.target).value)"
              aria-label="Sort events by date">
              <option value="upcoming-first">Soonest First</option>
              <option value="oldest-first">Newest First</option>
            </select>
          </div>

          <!-- Past Events Toggle -->
          <div class="col-md-6">
            <div class="form-check form-switch mt-4">
              <input 
                class="form-check-input" 
                type="checkbox" 
                role="switch"
                id="include-past-events"
                [checked]="includePastEvents()"
                (change)="togglePastEvents()"
                aria-label="Include past events in the listing">
              <label class="form-check-label" for="include-past-events">
                Include Past Events
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Events List -->
      @if (noEvents()) {
        <!-- Empty State -->
        <div class="empty-state text-center py-5">
          <div class="mb-4">
            <svg width="64" height="64" fill="currentColor" class="text-muted" viewBox="0 0 16 16" aria-hidden="true">
              <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
            </svg>
          </div>
          <h2 class="h4 mb-3">No Events Found</h2>
          <p class="text-muted mb-4">
            @if (includePastEvents()) {
              There are currently no events available.
            } @else {
              There are no upcoming events at this time. Check back later or enable "Include Past Events" to see previous events.
            }
          </p>
          <button 
            class="btn btn-outline-primary"
            (click)="togglePastEvents()"
            type="button">
            @if (includePastEvents()) {
              Show Only Upcoming Events
            } @else {
              Show Past Events
            }
          </button>
        </div>
      } @else {
        <!-- Events Grid -->
        <div class="events-grid" role="list">
          @for (event of displayedEvents(); track event.id) {
            <div role="listitem">
              <app-event-card [event]="event" />
            </div>
          }
        </div>

        <!-- Results Summary -->
        <div class="results-summary mt-4 text-center text-muted small">
          <p>Showing {{ displayedEvents().length }} event{{ displayedEvents().length !== 1 ? 's' : '' }}</p>
        </div>
      }
    }
  </div>
</div>
